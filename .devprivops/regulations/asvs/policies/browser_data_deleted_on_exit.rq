PREFIX dfd: <https://devprivops.com/dfd/>

SELECT ?dsId ?dtId
WHERE {
    dfd:ROOT dfd:data_stores ?dsId .
    ?dsId dfd:data_stored ?dataStored . 
    ?dataStored dfd:type ?dtId .

    ?dsId dfd:location "browser" .
    ?dtId dfd:category dfd:authenticated_only . # TODO: detect data obtained while authenticated

    FILTER NOT EXISTS {
        ?dataStored dfd:storage_period: "session" .
    }
}
