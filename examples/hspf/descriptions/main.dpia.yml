# yaml-language-server: $schema=../../global/schemas/dpia-schema.json

last update: 02/03/2004
responsible:
  - :John Doe
DPO:
  - name: John Smith
    contact: john.smith@dpocorp.com

personal data:
  - id: dfd:NetworkPacket
    kind: :personal # contains raw network data (potentially personal)
    required by law: []
    necessary to enter contract: []
    destinataries: 
      - :Collector
    retention period: 30d
    abides by code of conduct: false
    purposes:
      - :anonymization
    transfers to third parties: []
#   - id: dfd:AnonNetworkPacket
#     kind: :confidential
#     required by law: []
#     necessary to enter contract: []
#     destinataries: 
#       - :Collector
#       - :Aggregator
#       - :PolicyEnforcer
#     retention period: 30d
#     abides by code of conduct: false
#     purposes:
#       - :network security monitoring
#     transfers to third parties: []
  - id: dfd:Model
    kind: :confidential # The trained ML model is a high-value confidential asset
    required by law: []
    necessary to enter contract: []
    destinataries: 
      - :Aggregator
      - :Agent
    retention period: eternal
    abides by code of conduct: false
    purposes:
      - :network security monitoring
    transfers to third parties: []

risks:
  - id: Unauthorized access to raw network packets
    impact: 5 # severe, a full breach of personal data
    likelyhood: 2 # low
    accepted mitigations:
      - :Anonymization process
  - id: Model Exfiltration
    impact: 5 # severe, loss of intellectual property and a security asset
    likelyhood: 1 # very low
    accepted mitigations:
      - Access control on ModelStore

personal data processing whitelist:
  - :anonymization
  - :network security monitoring

personal data processing that requires DPIA:
  - dfd:Anonymization
  - dfd:Classification

processings:
  - id: dfd:Anonymization
    requires new technologies: true
    risk to rights and freedoms of:
      - :MicroService
    required for contract: []
    legally mandated: false
    vital interest: []
    public interest: false
    is official authority: false
    legitimate interest:
      - :MicroService
    professional secrecy: false
    scores users: false
    automated decisions: true
    legal impact for the user: false
    systematic monitoring: true
    large scale processing: true
    lawful: true
    fair: true
    transparent: false
    specific: true
    explicit: true
    legitimate: true
    purposes:
      - id: :anonymization
        adequate: true 
        relevant: true 
        limited: true
    risks:
      - :Unauthorized access to raw network packets
    supervisory authority veredict:
      contact:
        - :Supervisor
      allowed: true

  - id: dfd:Classification
    requires new technologies: true # it's a ml based model
    risk to rights and freedoms of:
      - :MicroService
    required for contract: []
    legally mandated: false
    vital interest: []
    public interest: true # network security might be of public interest
    is official authority: false
    legitimate interest:
      - :MicroService
    professional secrecy: false
    scores users: false # it scores network traffic, not users
    automated decisions: true # the classification is an automated decision
    legal impact for the user: false
    systematic monitoring: true
    large scale processing: true
    lawful: true
    fair: true
    transparent: false
    specific: true
    explicit: true
    legitimate: true
    purposes:
      - id: :network security monitoring
        adequate: true 
        relevant: true 
        limited: true
    risks:
      - :Model Exfiltration
    supervisory authority veredict:
      contact:
        - :Supervisor
      allowed: true
